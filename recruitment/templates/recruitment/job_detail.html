{% extends 'base.html' %}
{% load humanize %}

{% block title %}Job Details | SmartHR ERP{% endblock %}

{% block page_title %}
<h2 class="fw-bold mb-3" style="color: var(--accent-btn);">
    <i class="bi bi-briefcase-fill me-2"></i>{{ job.title }}
</h2>
{% endblock %}

{% block content %}
<style>
  :root {
    --sidebar-bg: #2f3e46;
    --sidebar-color: #ffffff;
    --sidebar-hover: #124e51;
    --active-bg: #52796f;
    --accent-btn: #3caea3;
    --accent-btn-hover: #2f8886;
    --topbar-bg: #ffffff;
    --topbar-border: #e0e0e0;
    --body-bg: #f8f9fa;
    --card-bg: #ffffff;
    --text-dark: #333333;
  }

  body {
    font-family: 'Inter', sans-serif;
    background-color: var(--body-bg);
    color: var(--text-dark);
  }

  /* Job Card */
  .job-card {
    background-color: var(--card-bg);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    padding: 2rem;
    transition: transform 0.2s;
  }
  .job-card:hover { transform: translateY(-3px); }

  .job-heading {
    color: var(--accent-btn);
    font-weight: 600;
  }

  .job-section-title {
    color: var(--accent-btn);
    font-weight: 600;
    margin-top: 1.25rem;
    margin-bottom: 0.5rem;
    border-left: 4px solid var(--accent-btn);
    padding-left: 8px;
  }

  .apply-btn {
    background-color: var(--accent-btn);
    border: none;
    padding: 0.75rem 2rem;
    font-size: 1.1rem;
    font-weight: 500;
    border-radius: 50px;
    transition: background-color 0.2s;
  }
  .apply-btn:hover { background-color: var(--accent-btn-hover); }

</style>

<div class="container">
    <div class="job-card">
        <!-- ===== All Details in One Flow ===== -->
        <h4 class="job-heading mb-2">
            Position: <span class="text-secondary">{{ job.title }}</span>
        </h4>
        <p class="text-muted mb-3">
            <strong>Job ID:</strong> {{ job.job_id }}
        </p>

        {% if job.location %}
            <p><strong>Location:</strong> {{ job.location }}</p>
        {% endif %}

        {% if job.department %}
            <p><strong>Department:</strong> {{ job.department.name }}</p>
        {% endif %}

        <p><strong>Vacancies:</strong> {{ job.vacancies }}</p>
        <p><strong>Work Mode:</strong> {{ job.work_mode }}</p>

        <p>
            <strong>Employment Type:</strong>
            {{ job.get_employment_type_display }}
        </p>

        {% if job.experience_min or job.experience_max %}
            <p>
                <strong>Experience:</strong>
                {% if job.experience_min and job.experience_max %}
                    {{ job.experience_min }} – {{ job.experience_max }} years
                {% elif job.experience_min %}
                    Minimum {{ job.experience_min }} years
                {% elif job.experience_max %}
                    Up to {{ job.experience_max }} years
                {% endif %}
            </p>
        {% endif %}

        {% if job.salary_min or job.salary_max %}
            <p>
                <strong>Compensation Range:</strong>
                {% if job.salary_min and job.salary_max %}
                    ₹{{ job.salary_min|intcomma }} – ₹{{ job.salary_max|intcomma }} / year
                {% elif job.salary_min %}
                    From ₹{{ job.salary_min|intcomma }} / year
                {% elif job.salary_max %}
                    Up to ₹{{ job.salary_max|intcomma }} / year
                {% endif %}
            </p>
        {% endif %}

        <!-- ✅ Now the description sections come right after Compensation -->
        {% if job.overview %}
            <h5 class="job-section-title">About the Role</h5>
            <p class="text-muted">{{ job.overview|linebreaks }}</p>
        {% endif %}

        {% if job.responsibilities %}
            <h5 class="job-section-title">Responsibilities</h5>
            <p class="text-muted">{{ job.responsibilities|linebreaks }}</p>
        {% endif %}

        {% if job.required_skills %}
            <h5 class="job-section-title">Required Skills</h5>
            <p class="text-muted">{{ job.required_skills|linebreaks }}</p>
        {% endif %}

        {% if job.preferred_skills %}
            <h5 class="job-section-title">Preferred Skills</h5>
            <p class="text-muted">{{ job.preferred_skills|linebreaks }}</p>
        {% endif %}

        {% if job.compensation_benefits %}
            <h5 class="job-section-title">Benefits</h5>
            <p class="text-muted">{{ job.compensation_benefits|linebreaks }}</p>
        {% endif %}

        {% if job.hiring_manager %}
            <p class="mt-3">
                <strong>Hiring Manager:</strong>
                {{ job.hiring_manager.get_full_name|default:job.hiring_manager.username }}
            </p>
        {% endif %}

        <hr class="my-4">

        <!-- Apply button -->
        <div class="text-center">
            <a href="{% url 'apply_for_job' job.id %}" class="btn apply-btn">
                <i class="bi bi-send-check-fill me-2"></i>Apply for this Job
            </a>
        </div>
    </div>
</div>
{% endblock %}
