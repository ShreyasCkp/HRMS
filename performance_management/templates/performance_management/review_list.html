{% extends 'base.html' %}
{% block title %}Performance Reviews{% endblock %}

{% block content %}
<style>
  :root {
    --sidebar-bg: #2f3e46;
    --sidebar-color: #ffffff;
    --sidebar-hover: #124e51;
    --active-bg: #52796f;
    --accent-btn: #3caea3;       /* Accent color */
    --accent-btn-hover: #2f8886; /* Hover color */
    --body-bg: #f8f9fa;
    --card-bg: #ffffff;
    --text-dark: #333333;
    --badge-approved: #3caea3;
    --badge-rejected: #e74c3c;
    --badge-pending: #f39c12;
  }

  body {
    background-color: var(--body-bg);
    color: var(--text-dark);
    font-family: 'Inter', sans-serif;
  }

  .recruitment-card {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  /* Themed Buttons */
  .btn-accent {
    background-color: var(--accent-btn) !important;
    color: #fff !important;
    border: none !important;
    border-radius: 6px;
    transition: background-color 0.2s ease;
  }
  .btn-accent:hover {
    background-color: var(--accent-btn-hover) !important;
  }

  /* Badge Styling */
  .badge-approved {
    background-color: var(--badge-approved) !important;
  }
  .badge-rejected {
    background-color: var(--badge-rejected) !important;
  }
  .badge-pending {
    background-color: var(--badge-pending) !important;
    color: #fff;
  }

  table.table th {
    background-color: #f1f3f5;
    font-weight: 600;
  }

  .table-hover tbody tr:hover {
    background-color: #e9f5f4;
    transform: translateY(-2px);
    transition: all 0.2s ease;
  }

  .modal-content {
    border-radius: 10px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  }
</style>

<div class="container mt-4">
  <div class="recruitment-card">
    <div class="mb-3 text-start">
      <a href="{% url 'review_add' %}" class="btn btn-accent">
        <i class="bi bi-plus-circle"></i> Add Review
      </a>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered align-middle table-hover">
        <thead class="table-light">
          <tr>
            <th>Employee</th>
            <th>Period</th>
            <th>Reviewer</th>
            <th>Avg. Score</th>
            <th>Feedback</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for review in reviews %}
          <tr>
            <td>{{ review.employee }}</td>
            <td>{{ review.review_period }}</td>
            <td>{{ review.reviewed_by }}</td>
            <td>{{ review.average_score }}</td>
            <td>{{ review.feedback|default:"-" }}</td>
            <td class="action-cell d-flex gap-1">
              <a href="{% url 'review_view' review.pk %}" class="btn btn-accent btn-sm" title="View">
                <i class="bi bi-eye"></i>
              </a>
              <a href="{% url 'review_edit' review.pk %}" class="btn btn-accent btn-sm" title="Edit">
                <i class="bi bi-pencil-square"></i>
              </a>
              <button type="button" class="btn btn-accent btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal{{ review.pk }}" title="Delete">
                <i class="bi bi-trash"></i>
              </button>

              <!-- Delete Modal -->
              <div class="modal fade" id="deleteModal{{ review.pk }}" tabindex="-1" aria-labelledby="deleteModalLabel{{ review.pk }}" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="deleteModalLabel{{ review.pk }}">Confirm Delete</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      Are you sure you want to delete the review for <strong>{{ review.employee }}</strong> ({{ review.review_period }})?
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                      <form action="{% url 'review_delete' review.pk %}" method="post" style="display:inline-block;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-accent">Yes, Delete</button>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <!-- End Delete Modal -->

            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" class="text-center text-muted">No reviews yet.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

{% endblock %}
